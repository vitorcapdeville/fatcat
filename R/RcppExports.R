# Generated by using Rcpp::compileAttributes() -> do not edit by hand
# Generator token: 10BE3573-1514-4C36-9D1C-5A225CD40393

algoritmo_logit <- function(y, nit, beta, sigma2, f, alfa, sdpropbeta, sdpropbeta2, sdpropf, sdpropsigma2, n, p, j, display_progress = TRUE) {
    .Call('_fatcat_algoritmo_logit', PACKAGE = 'fatcat', y, nit, beta, sigma2, f, alfa, sdpropbeta, sdpropbeta2, sdpropf, sdpropsigma2, n, p, j, display_progress)
}

#' Algoritmo de MH para gerar amostras da posteriori do modelo fatorial categórico ordenado probit
#'
#' @param y      [P x N] matriz de dados completa.
#' @param nit    [1 x 1] numero de interacoes
#' @param beta   [P x Q] valor inicial da matriz de cargas fatoriais.
#' @param f      [Q x N] valor inicial da matriz de fatores.
#' @param sigma2 [P x 1] valor inicial do vetor de variâncias.
#' @param alpha  [P x K + 1] matriz com os valores fixados dos pontos de corte.
#' @param C0     [1 x 1] variância das prioris para beta
#' @param a,b   [1 x 1] parametros de shape e scale da priori de sigma2
#' @param sdpropbeta,sdpropbeta2,sdpropf,sdpropsigma2 desvio padrao das propostas
#' @param display_progress TRUE para exibir o indicador de progresso.
#'
#' @export
algoritmo_probit <- function(y, nit, beta, f, sigma2, alpha, C0 = 10000, a = 0.001, b = 0.001, sdpropbeta = 0.05, sdpropbeta2 = 0.075, sdpropf = 0.4, sdpropsigma2 = 0.05, display_progress = TRUE) {
    .Call('_fatcat_algoritmo_probit', PACKAGE = 'fatcat', y, nit, beta, f, sigma2, alpha, C0, a, b, sdpropbeta, sdpropbeta2, sdpropf, sdpropsigma2, display_progress)
}

#' (log) Priori para beta_jl
#'
#' @param beta [1 x 1] valor do beta_jl
#' @param j    [1 x 1] escalar indicando qual é o j associado a beta_jl
#' @param l    [1 x 1] escalar indicando qual é o l associado a beta_jl
#' @param C0   [1 x 1] variancia da priori de beta.
#'
#' @details
#' As prioris para beta são:
#' beta_jl ~ N(0, C0), se j < l
#' beta_jl ~ N(0, C0)I(0, +infty), se j == l
#' beta_jl = 0 se j > l
#'
#' @return [1 x 1] escalar com o valor do log da densidade (nucleo) de beta_jl
#'
#' @export
l_priori_beta_jl <- function(beta, j, l, C0 = 10000) {
    .Call('_fatcat_l_priori_beta_jl', PACKAGE = 'fatcat', beta, j, l, C0)
}

#' (log) Priori para beta_j.
#'
#' @param beta [1 x Q] vetor linha com os betas que associam a j-esima variavel e cada um dos Q fatores.
#' @param j    [1 x 1] escalar indicando qual é o j associado ao beta_j fornecido.
#' @param C0   [1 x 1] variancia da priori de beta.
#'
#' @return [1 x 1] escalar com o valor do log da densidade (nucleo)
#'
#' @export
l_priori_beta_j <- function(beta, j, C0 = 10000) {
    .Call('_fatcat_l_priori_beta_j', PACKAGE = 'fatcat', beta, j, C0)
}

#' (log) Priori completa de beta.
#'
#' @param beta [P x Q] matriz beta completa.
#' @param C0   [1 x 1] variancia da priori de beta.
#'
#' @return [1 x 1] escalar com o valor do log da densidade (nucleo)
#'
#' @export
l_priori_beta <- function(beta, C0 = 10000) {
    .Call('_fatcat_l_priori_beta', PACKAGE = 'fatcat', beta, C0)
}

#' (log) Priori para f_li
#'
#' @param f [1 x 1] valor de f_li
#'
#' @details
#' A priori para f é
#' f_li ~ N(0, 1)
#'
#' @return [1 x 1] escalar com o valor do log da densidade (nucleo)
#'
#' @export
l_priori_f_li <- function(f) {
    .Call('_fatcat_l_priori_f_li', PACKAGE = 'fatcat', f)
}

#' (log) Priori para f_i
#'
#' @param f [Q x 1] vetor coluna com os Q fatores associados a i-ésima observacao.
#'
#' @return [1 x 1] escalar com o valor do log da densidade (nucleo)
#'
#' @export
l_priori_f_i <- function(f) {
    .Call('_fatcat_l_priori_f_i', PACKAGE = 'fatcat', f)
}

#' (log) Priori para f
#'
#' @param f [Q x N] matriz f completa.
#'
#' @return [1 x 1] escalar com o valor do log da densidade (nucleo)
#'
#' @export
l_priori_f <- function(f) {
    .Call('_fatcat_l_priori_f', PACKAGE = 'fatcat', f)
}

#' (log) Priori para sigma2_j
#'
#' @param sigma2 [1 x 1] valor da variancia da j-ésima variavel
#' @param a      [1 x 1] parametro de shape da IG.
#' @param b      [1 x 1] parametro de scale da IG.
#'
#' @details
#' A priori para sigma2_j é
#' sigma2_j ~ IG(a, b)
#' f(sigma2_j) propto sigma2_j^(- a - 1) exp (-b/sigma2_j)
#'
#' @return [1 x 1] escalar com o valor do log da densidade (nucleo)
#'
#' @export
l_priori_sigma2_j <- function(sigma2, a = 0.001, b = 0.001) {
    .Call('_fatcat_l_priori_sigma2_j', PACKAGE = 'fatcat', sigma2, a, b)
}

#' (log) Priori para sigma2
#'
#' @param sigma2 [P x 1] vetor com as variancias das p variáveis.
#' @param a      [1 x 1] parametro de shape da IG.
#' @param b      [1 x 1] parametro de scale da IG.
#'
#' @return [1 x 1] escalar com o valor do log da densidade (nucleo)
#'
#' @export
l_priori_sigma2 <- function(sigma2, a = 0.001, b = 0.001) {
    .Call('_fatcat_l_priori_sigma2', PACKAGE = 'fatcat', sigma2, a, b)
}

#' P(Y_ij <= k) - Probabilidade da i-ésima observação da j-ésima variável estar abaixo da categoria k. (PROBIT)
#'
#' @param alpha   [1 x 1] escalar com o ponto de corte associado a k-ésima categoria.
#' @param beta   [1 x Q] vetor linha com os betas que associam a j-esima variavel e cada um dos Q fatores.
#' @param f      [Q x 1] vetor coluna com os Q fatores associados a i-ésima observacao.
#' @param sigma2 [1 x 1] escalar com a variância associada à j-ésima variável.
#'
#' @return       [1 x 1] ecalar com a probabilidade de y_ij cair abaixo da categoria k.
#'
#' @export
delta_ijk_probit <- function(alpha, beta, f, sigma2) {
    .Call('_fatcat_delta_ijk_probit', PACKAGE = 'fatcat', alpha, beta, f, sigma2)
}

delta_ijk_marginal_probit <- function(alpha, beta, sigma2) {
    .Call('_fatcat_delta_ijk_marginal_probit', PACKAGE = 'fatcat', alpha, beta, sigma2)
}

#' P(Y_ij = k) - Probabilidade da i-ésima observação da j-ésima variável estar abaixo da categoria k. (PROBIT)
#'
#' @param alpha   [1 x 2] vetor com os pontos de corte associados a (k-1)-ésima e (k)-ésima categorias.
#' @param beta   [1 x Q] vetor linha com os betas que associam a j-esima variavel e cada um dos Q fatores.
#' @param f      [Q x 1] vetor coluna com os Q fatores associados a i-ésima observacao.
#' @param sigma2 [1 x 1] escalar com a variância associada à j-ésima variável.
#'
#' @return       [1 x 1] ecalar com a probabilidade de y_ij ser exatamente igual acategoria k.
#'
#' @export
p_ijk_probit <- function(alpha, beta, f, sigma2) {
    .Call('_fatcat_p_ijk_probit', PACKAGE = 'fatcat', alpha, beta, f, sigma2)
}

p_ijk_marginal_probit <- function(alpha, beta, sigma2) {
    .Call('_fatcat_p_ijk_marginal_probit', PACKAGE = 'fatcat', alpha, beta, sigma2)
}

#' P(Y_j = y_j) - (log) Verossimilhanca para a j ésima variavel.
#'
#' @param y      [1 x N] vetor com as n obersavoes para a j-esima variavel.
#' @param alpha   [1 x (K+1)] vetor com os todos os K + 1 pontos de corte.
#' @param beta   [1 x Q] vetor linha com os betas que associam a j-esima variavel e cada um dos Q fatores.
#' @param f      [Q x N] matriz f completa.
#' @param sigma2 [1 x 1] escalar com a variância associada à j-ésima variável.
#'
#' @return       [1 x 1]  ecalar com a log verossimilhanca para todas as observacoes da variavel j.
#'
#' @export
l_vero_j_probit <- function(y, alpha, beta, f, sigma2) {
    .Call('_fatcat_l_vero_j_probit', PACKAGE = 'fatcat', y, alpha, beta, f, sigma2)
}

l_vero_j_marginal_probit <- function(y, alpha, beta, sigma2) {
    .Call('_fatcat_l_vero_j_marginal_probit', PACKAGE = 'fatcat', y, alpha, beta, sigma2)
}

#' P(Y_i = y_i) - (log) Verossimilhanca para a i-esima observacao.
#'
#' @param y      [P x 1] vetor com as p variaveis para a i-esima observacao.
#' @param alpha   [P x (K+1)]  Matriz alpha com os todos os K + 1 pontos de corte. Pontos de
#' corte podem diferir para diferentes variaveis, embora nao seja usual.
#' @param beta   [P x Q] matriz beta completa.
#' @param f      [Q x 1] vetor coluna com os Q fatores associados a i-ésima observacao.
#' @param sigma2 [P x 1] vetor sigma2 completo.
#'
#' @return       [1 x 1]  ecalar com a log verossimilhanca para todas as variaveis da observacao i.
#'
#' @export
l_vero_i_probit <- function(y, alpha, beta, f, sigma2) {
    .Call('_fatcat_l_vero_i_probit', PACKAGE = 'fatcat', y, alpha, beta, f, sigma2)
}

#' P(Y = y) - (log) Verossimilhanca (completa).
#'
#' @param y      [P x N] matriz de dados completa.
#' @param alpha   [P x (K+1)] Matriz alpha com os todos os K + 1 pontos de corte. Pontos de
#' corte podem diferir para diferentes variaveis, embora nao seja usual.
#' @param beta   [P x Q] matriz beta completa.
#' @param f      [Q x N] matriz f completa.
#' @param sigma2 [P x 1] vetor sigma2 completo.
#'
#' @return       [1 x 1] ecalar com a log verossimilhanca completa.
#'
#' @export
l_vero_probit <- function(y, alpha, beta, f, sigma2) {
    .Call('_fatcat_l_vero_probit', PACKAGE = 'fatcat', y, alpha, beta, f, sigma2)
}

l_vero_marginal_probit <- function(y, alpha, beta, sigma2) {
    .Call('_fatcat_l_vero_marginal_probit', PACKAGE = 'fatcat', y, alpha, beta, sigma2)
}

